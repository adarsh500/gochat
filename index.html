<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<body>
    <div id="log"></div>
    <form id="form">
        <input type="text" id="msg" autofocus />
        <button>Send</button>
    </form>
</body>
<script>
    window.onload = () => {
        let msg = document.getElementById("msg")
        let log = document.getElementById("log")
        let conn = new WebSocket("ws://" + document.location.host + "/ws")
        conn.onclose = (e) => {
            let item = document.createElement("div")
            item.innerHTML = "<b>Connection closed.</b>"
            log.appendChild(item)
        }
        conn.onmessage = (e) => {
            let msgs = e.data.split('\n')
            for (let i = 0; i < msgs.length; i++) {
                let item = document.createElement("div")
                item.innerText = msgs[i]
                log.appendChild(item)
            }
        }
        document.getElementById("form").onsubmit = () => {
            if (!conn) {
                return false
            }
            if (!msg.value) {
                return false
            }
            conn.send(msg.value)
            msg.value = ""
            return false
        }
    }
</script>
<style>
body {
    width: 100%;
    height: 100%;
    background: darkslateblue;
}

#log {
    background: white;
    margin: 1em;
    padding: 0.5em 0.5em;
    position: absolute;
    top: 0;
    left: 25%;
    right: 25%;
    bottom: 3em;
    overflow: auto;
}

input {
    width: 44%;
    position: absolute;
    bottom: 1.5em;
    left: 26%;
}

button {
    position:absolute;
    bottom: 1.5em;
    right: 26%;
}

</style>
